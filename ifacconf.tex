%===============================================================================
% ifacconf.tex 2025-07-31 jpuente  
% 2022-11-11 jpuente change length of abstract
% 2025-07-31 jldiez added section on the use of AI
% Template for IFAC meeting papers
% Copyright (c) 2025 International Federation of Automatic Control
%===============================================================================
\documentclass{ifacconf}

\usepackage{graphicx}      % include this line if your document contains figures
\usepackage{natbib}        % required for bibliography
%===============================================================================
\begin{document}
\begin{frontmatter}

\title{Dynamic Penetrative Trajectory Adaptation\thanksref{footnoteinfo}} 
% Title, preferably not more than 10 words.

\thanks[footnoteinfo]{Sponsor and financial support acknowledgment
goes here. Paper titles should be written in uppercase and lowercase
letters, not all uppercase.}

\author[First]{Zhifeng Han. Author} 
\author[Second]{Clarire Walton. Author, Jr.} 


\address[First]{University of Texas at San Antonio, 
   San Antonio, TX 78249 USA (e-mail: zhifeng.han@utsa.edu).}
\address[Second]{University of Texas at San Antonio, 
   San Antonio, TX 78249 USA (e-mail: claire.walton@utsa.edu).}
%\address[Third]{Electrical Engineering Department, 
%   Seoul National University, Seoul, Korea, (e-mail: author@snu.ac.kr)}

\begin{abstract}                % Abstract of 50--100 words
DPTA is a conceptual framework where the LLM's world knowledge is leveraged to analyze low-level sensor feedback, enabling the dynamic selection and refinement of complex, pre-learned robot trajectories to achieve 
high dexterity and resilience in autonomous manipulation.
\end{abstract}

\begin{keyword}
LLM, robotic, Reenforcement Learning.
\end{keyword}

\end{frontmatter}
%===============================================================

\section{Introduction}
interactive robots mission is a complex mission it need to nagvigate in complex and 
dynamic environment also need to fully flexable to planing the sequentially sub tasks. 
In order to achieve the goal we demo a method by utlize LLMs(large language model) and Reenforcement Learning. 
Our idea focuses on using an LLM's capacity for precise, short-horizon physical reasoning to 
dynamically select or modify the parameters of complex, learned robotic trajectories, 
effectively allowing the robot to autonomously execute tasks that previously required initial human intervention.
The conceptual framework of Dynamic Penetrative Trajectory Adaptation (DPTA) represents a synthesis of three distinct advanced AI paradigms found in the sources: Penetrative AI (LLM sensor comprehension), 
Dynamic Movement Primitives (DMP) and Human-Robot Collaboration (HRC) for trajectory learning, 
and Robust Reinforcement Learning (RL) for policy optimization and action excution.



\section{Background}

The complex nature of interactive robot missions, particularly those involving high-level 
language models (LLMs) or sophisticated reinforcement learning (RL), 
presents numerous challenges across planning, learning, perception, and execution.

\subsection{Main challenges}

\textbf{Limitations in High-Level Planning and Trajectory Execution (LLMs):}
When LLMs are used for autonomous manipulation, they encounter issues related to generating and executing physical motions:
Inability to Handle Complex Trajectories(\cite{liu2024enhancing}) (Feasibility Issues): The conventional approach of 
using LLMs to generate code for robot motion falters when dealing with complex trajectories. 
Tasks that require intricate trajectory planning and reasoning over environments, such as 
opening an oven door featuring a horizontal axis design or opening a cabinet with a press-pull 
structure, may be deemed infeasible when relying only on the basic motion library generated by 
the LLM(\cite{liu2024enhancing}).
Fragility of Prompt Design: The current design paradigm for using LLMs as controllers is 
fragile, meaning even minor alterations in the prompt can dramatically affect the performance.\cite{wang2024prompt} 
Designing a reliable prompt for robotic tasks is not yet well understood.

\textbf{Executability Anomalies:} Although generally high, the code generated by the LLM can 
 occasionally generate sub-tasks without assigning corresponding motion 
 functions, resulting in non-encodable and non-executable responses(\cite{liu2024enhancing}).

\textbf{Issues Related to Perception and Grounding:}

Successfully linking high-level instructions to the physical world introduces multiple errors:
Environmental Perception Errors and Error Accumulation: Real-world task success rates decrease 
due to error accumulation across sequential sub-tasks(\cite{liu2024enhancing}). 
Errors in environmental perception stem from inaccuracies in object detection models (
   like YOLOv5), 
such as bounding box inaccuracies, leading to slightly variable coordinates for target objects.\cite{liu2024enhancing} 
These discrepancies can cause the errors to exceed the necessary margins for precise manipulation 
(e.g., placing an apple into an oven with minimal clearance)(\cite{liu2024enhancing})
Sensor Data Processing Limitations: LLMs, when used in a "penetrative" way to analyze 
digitized sensor signals (like sequences of ECG digits), exhibit lower 
efficiency in processing extensive sequences of digital data compared to traditional methods(\cite{xu2024penetrative}).
 The hallucination rates and Mean Absolute Errors (MAEs) for some LLMs escalate with the 
 increase in window size of the input data, suggesting an inherent limitation in processing 
 extensive lengths of digitized sequences(\cite{xu2024penetrative}).
Susceptibility to Deployment Noise: Policies trained in simulation, even when using modern techniques, 
may not be robust to real-world noise. For instance, a policy trained in simulation for pick-and-place was not 
robust to small errors in box position estimation (e.g., errors with a standard deviation of 1cm) when deployed 
on a physical robot(\cite{andrychowicz2017hindsight}).

\textbf{Challenges in Low-Level Control:}

Controllability and Security Risks: Since LLM responses are probabilistic, there is no guarantee that the swarm will behave as intended. This also introduces new security vulnerabilities, as it needs to be studied if users or even other robots can reprogram robots through prompt injection attacks or 
if a malicious agent could send misleading information (Byzantine robot detection)(\cite{strobel2024llm2swarm}).



\subsection{ Overview: Dynamic Penetrative Trajectory Adaptation (DPTA)}

In current LLM-based manipulation, environmental information is 
primarily derived visually (e.g., YOLOv5 for object position)(\cite{liu2024enhancing}). 
However, fine-grained tasks often depend on non-visual physical 
feedback (e.g., force or torque required to open a tight hinge). 
In DPTA, the Penetrative AI(\cite{xu2024penetrative}) paradigm is employed to process digitized sensor 
signals** from the robot's end effector 
(e.g., force/torque sensors, joint current feedback)

\begin{itemize}   

\item LLM's task is not to determine a broad state (like "indoors/outdoors"), 
but to execute a real-time, micro-level physical classification of the 
object/environment state during the initial phase of interaction 
(e.g., the first 100 milliseconds of grasping a handle or pushing a button)\cite{bhat2024grounding}.

\item Prompt Design: Our prompt utilizes the procedural guidance and fuzzy logic methods demonstrated in 
the heart rate detection task.(\cite{xu2024penetrative}) It contains a short sequence of 
raw numerical feedback (avoiding the token limit constraint associated with 
long digitized sequences) and instructs the LLM to classify the physical anomaly based on 
relative changes in the sequence.

\item Example Output: Based on the input torque sequence, the LLM reasoning(\cite{liu2024enhancing}) determines the precise 
physical condition, such as "Horizontal-Axis Oven Door, 
stiff hinge" or "Press-Pull Cabinet, high friction."

\item Dynamic Controller Role: The LLM functions as a \textbf{dynamic feedback controller}, selecting between:



\end{itemize}

\subsection{Literature Review}

The proposed Dynamic Penetrative Trajectory Adaptation (DPTA) framework differentiates itself from existing research in LLM-controlled robotics by addressing limitations in physical grounding, low-level trajectory execution, and robust policy learning.
\begin{enumerate} 

\item \textbf{High-Level Planning with Imperfect Grounding}
Existing works leverage large language models (LLMs) as \textbf{zero-shot planners} to decompose high-level instructions (e.g., "make breakfast") 
into a sequence of actionable steps [\cite{huang2022language}]. Methods like those involving \textbf{Semantic Translation} improve executability 
by mapping LLM-generated phrases to the most semantically similar admissible action in a predefined set. 
\textbf{SayCan} grounds LLM output by weighting actions based on learned \textbf{skill affordances} (value functions), 
ensuring the proposed step is feasible in the current state [\cite{brohan2023can}].

\textbf{Limitation: Reliance on Narrow APIs and Lack of Deep Physical Context}

Despite these efforts, LLM-generated plans are still frequently not executable in interactive environments (\cite{huang2022language}) and 
struggle with mid-level grounding, often missing necessary common-sense actions [\cite{huang2022language}].    
Critically, most systems rely on predetermined \textbf{vision APIs} (like object detectors) to describe the scene [\cite{vemprala2024chatgpt}]. 
This focus on visual data ignores crucial non-visual \textbf{physical feedback} (e.g., force or torque) needed for fine-grained tasks [\cite{huang2023inner}], 
leaving the LLM policies restricted by \textbf{what the perception APIs can describe} [\cite{brown2020language}].

\item \textbf{Code Generation and Trajectory Management}

Recent research utilizes LLMs to directly generate \textbf{policy code (Code as Policies)}, allowing the model to compose 
perception-to-control logic and reference external libraries (like NumPy) for complex behaviors such as spatial-geometric reasoning [\cite{liang2023code}]. 
Furthermore, LLMs have been explored as \textbf{low-level feedback policies} for dynamic systems like robot walking by outputting target joint positions 
directly from historical input-output sequences [\cite{liang2023code}].


\item \textbf{Closed-Loop Adaptation and Policy Learning}

Systems such as \textbf{Inner Monologue} and \textbf{Socratic Models} integrate closed-loop feedback by feeding natural language 
observations (e.g., success detection or scene description updates) back into the LLM prompt, enabling the LLM planner to reason over outcomes and 
dynamically re-plan actions [huang2023inner]. In the domain of reinforcement learning (RL), solving robotic tasks often faces the critical challenge of 
\textbf{sparse and binary rewards} [\cite{andrychowicz2017hindsight}].

$\to$ \textbf{Limitation: Feedback Limitations and Learning Inefficiency}

The effectiveness of closed-loop reasoning is **bottlenecked** by the capabilities of the low-level control policies and the fidelity of the 
language description provided by the perception system [15, 29]. Moreover, traditional RL systems often fail in large state spaces when faced with 
sparse rewards, often necessitating tedious and domain-specific **reward function engineering** [28].

$\to$ \textbf{Your Approach: Robust Reinforcement Learning Integration}

DPTA incorporates **Hindsight Experience Replay (HER)**, an advanced RL principle, to efficiently train universal policies that overcome the challenge 
of sparse rewards [28]. HER allows the system to **re-examine failed trajectories** with the retrospectively achieved state treated as a successful goal, 
thus harvesting information even from episodes that originally received a reward of $-1$ [28]. This enhances the policy learning component, ensuring the 
executed policies remain resilient and adaptable over time [28].
\end{enumerate}

% \subsection{Equations}

% Some words might be appropriate describing equation~(\ref{eq:sample}), if 
% we had but time and space enough. 

% \begin{equation} \label{eq:sample}
% {{\partial F}\over {\partial t}} = D{{\partial^2 F}\over {\partial x^2}}.
% \end{equation}

% See \cite{Abl:56}, \cite{AbTaRu:54}, \cite{Keo:58} and \cite{Pow:85}.

% \subsubsection{Example.} This equation goes far beyond the
% celebrated theorem ascribed to the great Pythagoras by his followers.

% \begin{thm}   % use the thm environment for theorems
% The square of the length of the hypotenuse of a right triangle equals
% the sum of the squares of the lengths of the other two sides.
% \end{thm}

% \begin{pf}    % and the pf environment for proofs
% The square of the length of the hypotenuse of a right triangle equals the sum of the squares 
% of the lengths of the other two sides.
% \end{pf}

% %% There are a number of predefined theorem-like environments in
% %% ifacconf.cls:
% %%
% %% \begin{thm} ... \end{thm}            % Theorem
% %% \begin{lem} ... \end{lem}            % Lemma
% %% \begin{claim} ... \end{claim}        % Claim
% %% \begin{conj} ... \end{conj}          % Conjecture
% %% \begin{cor} ... \end{cor}            % Corollary
% %% \begin{fact} ... \end{fact}          % Fact
% %% \begin{hypo} ... \end{hypo}          % Hypothesis
% %% \begin{prop} ... \end{prop}          % Proposition
% %% \begin{crit} ... \end{crit}          % Criterion

% Of course LaTeX manages equations through built-in macros. You may
% wish to use the \texttt{amstex} package for enhanced math
% capabilities.

% \subsection{Figures}

% To insert figures, use the \texttt{graphicx} package. Although other
% graphics packages can also be used, \texttt{graphicx} is simpler to
% use. See  Fig.~\ref{fig:bifurcation} for an example.

% \begin{figure}
% \begin{center}
% \includegraphics[width=8.4cm]{bifurcation}    % The printed column width is 8.4 cm.
% \caption{Bifurcation: Plot of local maxima of $x$ with damping $a$ decreasing} 
% \label{fig:bifurcation}
% \end{center}
% \end{figure}

% Figures must be centered, and have a caption at the bottom. 

% \subsection{Tables}
% Tables must be centered and have a caption above them, numbered with
% Arabic numerals. See table~\ref{tb:margins} for an example.

% \begin{table}[hb]
% \begin{center}
% \caption{Margin settings}\label{tb:margins}
% \begin{tabular}{cccc}
% Page & Top & Bottom & Left/Right \\\hline
% First & 3.5 & 2.5 & 1.5 \\
% Rest & 2.5 & 2.5 & 1.5 \\ \hline
% \end{tabular}
% \end{center}
% \end{table}

% \subsection{Final Stage}

% Authors are expected to mind the margins diligently.  Papers need to
% be stamped with event data and paginated for inclusion in the
% proceedings. If your manuscript bleeds into margins, you will be
% required to resubmit and delay the proceedings preparation in the
% process.

% \subsubsection{Page margins.} See table~\ref{tb:margins} for the
% page margins specification. All dimensions are in \emph{centimeters}.


% \subsection{PDF Creation}

% All fonts must be embedded/subsetted in the PDF file. Use one of the
% following tools to produce a good quality PDF file:

% \subsubsection{PDFLaTeX} is a special version of LaTeX by Han The
% Thanh which produces PDF output directly using Type-1 fonts instead of
% the standard \texttt{dvi} file. It accepts figures in JPEG, PNG, and PDF
% formats, but not PostScript. Encapsulated PostScript figures can be
% converted to PDF with the \texttt{epstopdf} tool or with Adobe Acrobat
% Distiller.

% \subsubsection{Generating PDF from PostScript} is the classical way of
% producing PDF files from LaTeX. The steps are:

% \begin{enumerate}
%   \item Produce a \texttt{dvi} file by running \texttt{latex} twice.
%   \item Produce a PostScript (\texttt{ps}) file with \texttt{dvips}.
%   \item Produce a PDF file with \texttt{ps2pdf} or Adobe Acrobat
%   Distiller.
% \end{enumerate}

% \subsection{Copyright Form}

% IFAC will put in place an electronic copyright transfer system in due
% course. Please \emph{do not} send copyright forms by mail or fax. More
% information on this will be made available on IFAC website.


% \section{Units}

% Use SI as primary units. Other units may be used as secondary units
% (in parentheses). This applies to papers in data storage. For example,
% write ``$15\,\mathrm{Gb}/\mathrm{cm}^2$ ($100\,\mathrm{Gb}/\mathrm{in}^2$)''. 
% An exception is when
% English units are used as identifiers in trade, such as ``3.5 in
% disk drive''. Avoid combining SI and other units, such as current in
% amperes and magnetic field in oersteds. This often leads to confusion
% because equations do not balance dimensionally. If you must use mixed
% units, clearly state the units for each quantity in an equation.  The
% SI unit for magnetic field strength $\mathbf{H}$ is $\mathrm{A}/\mathrm{m}$. However, if you wish to
% use units of $\mathrm{T}$, either refer to magnetic flux density $\mathbf{B}$ or
% magnetic field strength symbolized as $\mu_0\,\mathbf{H}$. Use the center dot to
% separate compound units, e.g., ``$\mathrm{A} \cdot \mathrm{m}^2$''.

% \section{Helpful Hints}

% \subsection{Figures and Tables}

% Figure axis labels are often a source of confusion. Use words rather
% than symbols. As an example, write the quantity ``Magnetization'', or
% ``Magnetization M'', not just ``M''. Put units in parentheses. Do not
% label axes only with units.  For example, write ``Magnetization
% ($\mathrm{A}/\mathrm{m}$)'' or ``Magnetization ($\mathrm{A} \mathrm{m}^{-1}$)'', not just
%  ``$\mathrm{A}/\mathrm{m}$''. Do not
% label axes with a ratio of quantities and units. For example, write
% ``Temperature ($\mathrm{K}$)'', not ``$\mbox{Temperature}/\mathrm{K}$''.

% Multipliers can be especially confusing. Write ``Magnetization
% ($\mathrm{kA}/\mathrm{m}$)'' or ``Magnetization ($10^3 \mathrm{A}/\mathrm{m}$)''. Do not write
% ``Magnetization $(\mathrm{A}/\mathrm{m}) \times 1000$'' because the reader would not know
% whether the axis label means $16000\,\mathrm{A}/\mathrm{m}$ or $0.016\,\mathrm{A}/\mathrm{m}$.

% \subsection{References}

% Use Harvard style references (see at the end of this document). With
% \LaTeX, you can process an external bibliography database 
% using \texttt{bibtex},\footnote{In this case you will also need the \texttt{ifacconf.bst}
% file, which is part of the \texttt{ifaconf} package.}
% or insert it directly into the reference section. Footnotes should be avoided as
% far as possible.  Please note that the references at the end of this
% document are in the preferred referencing style. Papers that have not
% been published should be cited as ``unpublished''.  Capitalize only the
% first word in a paper title, except for proper nouns and element
% symbols.

% \subsection{Abbreviations and Acronyms}

% Define abbreviations and acronyms the first time they are used in the
% text, even after they have already been defined in the
% abstract. Abbreviations such as IFAC, SI, ac, and dc do not have to be
% defined. Abbreviations that incorporate periods should not have
% spaces: write ``C.N.R.S.'', not ``C. N. R. S.'' Do not use abbreviations
% in the title unless they are unavoidable (for example, ``IFAC'' in the
% title of this article).

% \subsection{Equations}

% Number equations consecutively with equation numbers in parentheses
% flush with the right margin, as in (\ref{eq:sample}).  To make your equations more
% compact, you may use the solidus ($/$), the $\exp$ function, or
% appropriate exponents. Use parentheses to avoid ambiguities in
% denominators. Punctuate equations when they are part of a sentence, as
% in

% \begin{equation} \label{eq:sample2}
% \begin{array}{ll}
% \int_0^{r_2} & F (r, \varphi ) dr d\varphi = [\sigma r_2 / (2 \mu_0 )] \\
% & \cdot \int_0^{\inf} exp(-\lambda |z_j - z_i |) \lambda^{-1} J_1 (\lambda  r_2 ) J_0 (\lambda r_i ) d\lambda 
% \end{array}
% \end{equation}

% Be sure that the symbols in your equation have been defined before the
% equation appears or immediately following. Italicize symbols ($T$
% might refer to temperature, but T is the unit tesla). Refer to
% ``(\ref{eq:sample})'', not ``Eq. (\ref{eq:sample})'' or ``equation
% (\ref{eq:sample})'', except at the beginning of a sentence: ``Equation
% (\ref{eq:sample}) is \ldots''.

% \subsection{Other Recommendations}

% Use one space after periods and colons. Hyphenate complex modifiers:
% ``zero-field-cooled magnetization''. Avoid dangling participles, such
% as, ``Using (1), the potential was calculated'' (it is not clear who or
% what used (1)). Write instead: ``The potential was calculated by using
% (1)'', or ``Using (1), we calculated the potential''.

% A parenthetical statement at the end of a sentence is punctuated
% outside of the closing parenthesis (like this). (A parenthetical
% sentence is punctuated within the parentheses.) Avoid contractions;
% for example, write ``do not'' instead of ``don' t''. The serial comma
% is preferred: ``A, B, and C'' instead of ``A, B and C''.


% \section{Conclusion}

% A conclusion section is not required. Although a conclusion may review
% the main points of the paper, do not replicate the abstract as the
% conclusion. A conclusion might elaborate on the importance of the work
% or suggest applications and extensions.

% \begin{ack}
% Place acknowledgments here.
% \end{ack}

% \section*{DECLARATION OF GENERATIVE AI AND AI-ASSISTED TECHNOLOGIES IN THE WRITING PROCESS}
% During the preparation of this work the author(s) used [NAME TOOL / SERVICE] in order to [REASON]. After using this tool/service, the author(s) reviewed and edited the content as needed and take(s) full responsibility for the content of the publication.


\bibliography{ifacconf}             % bib file to produce the bibliography
                                                     % with bibtex (preferred)
                                                   
%\begin{thebibliography}{xx}  % you can also add the bibliography by hand

%\bibitem[Able(1956)]{Abl:56}
%B.C. Able.
%\newblock Nucleic acid content of microscope.
%\newblock \emph{Nature}, 135:\penalty0 7--9, 1956.

%\bibitem[Able et~al.(1954)Able, Tagg, and Rush]{AbTaRu:54}
%B.C. Able, R.A. Tagg, and M.~Rush.
%\newblock Enzyme-catalyzed cellular transanimations.
%\newblock In A.F. Round, editor, \emph{Advances in Enzymology}, volume~2, pages
%  125--247. Academic Press, New York, 3rd edition, 1954.

%\bibitem[Keohane(1958)]{Keo:58}
%R.~Keohane.
%\newblock \emph{Power and Interdependence: World Politics in Transitions}.
%\newblock Little, Brown \& Co., Boston, 1958.

%\bibitem[Powers(1985)]{Pow:85}
%T.~Powers.
%\newblock Is there a way out?
%\newblock \emph{Harpers}, pages 35--47, June 1985.

%\bibitem[Soukhanov(1992)]{Heritage:92}
%A.~H. Soukhanov, editor.
%\newblock \emph{{The American Heritage. Dictionary of the American Language}}.
%\newblock Houghton Mifflin Company, 1992.

%\end{thebibliography}

\appendix
\section{A summary of Latin grammar}    % Each appendix must have a short title.
\section{Some Latin vocabulary}              % Sections and subsections are supported  
                                                                         % in the appendices.
\end{document}
